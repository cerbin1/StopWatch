<!DOCTYPE html>
<html lang="pl">
<head>
    <title>Countdown</title>
    <meta charset="utf-8">
    <link rel="stylesheet" href="style.css">
    <script src="https://ajax.aspnetcdn.com/ajax/jQuery/jquery-3.2.1.min.js"></script>
</head>
<body>
<div class="container">
    <div id="timer" class="buttons">00:00:00</div>
    <div class="navbar">
        <ul class="countdown-buttons">
            <li id="startPause" class="centering-buttons" onclick="startPause()">Start</li>
            <li id="reset" onclick="reset()">Reset</li>
        </ul>
    </div>

    <div class="backButton"><a href="index.html">Back</a></div>
    <label>Minutes<input id="minutes" type="number" value="0"></label>
    <label>Seconds<input id="seconds" type="number" value="0"></label>
    <input class="input-button" type="button" onclick="setCountdown()" value="Set">

</div>
<script>
    var interval;
    var time = 0;
    var running = false;
    var isCountdownSet = false;
    var soundEffect = new Audio('sound/phone_sound_effect.mp3');

    var seconds;
    var minutes;
    var hours;

    function setCountdown() {
        if (running) {
            console.log("licznik teraz dziala, nie mozna ustawic innego czasu");
        } else {
            seconds = parseInt($('#seconds').val(), 10);
            minutes = parseInt($('#minutes').val(), 10);
            hours = Math.floor(minutes / 60);

            if (seconds < 0 || minutes < 0) {
                console.log("nie moze byc ujemnego czasu");
            } else if (seconds === 0 && minutes === 0) {
                console.log("Musisz wpisac jakis czas, nie moze byc zerowy");
            } else {
                displayTimer();

                isCountdownSet = true;
                time = +seconds + minutes * 60;
            }
        }
    }

    function displayTimer() {
        var displaySeconds = ":";
        var displayMinutes = ":";
        var displayHours = "";

        if (seconds < 10) {
            displaySeconds = ":0";
        }
        if (seconds % 60 === 0) {
            displaySeconds = ":0";
        }
        if (minutes < 10) {
            displayMinutes = ":0";
        }
        if (hours < 10) {
            displayHours = "0";
        }
        $('#timer').text(displayHours + hours +
            displayMinutes + minutes + displaySeconds + seconds % 60);
    }

    function startPause() {
        if (running) {
            running = false;
            clearInterval(interval);
            document.getElementById("startPause").innerHTML = "Resume";
            console.log("zapausowalem");
        }
        else if (time === 0) {
            console.log("uzytkownik nie wprowadzil zadnych wartosci");
        } else {
            console.log("odpalilem");
            running = true;
            document.getElementById("startPause").innerHTML = "Pause";
            decrement();
        }
    }

    function decrement() {
        console.log(time);
        interval = setInterval(function () {
            time--;

            console.log(time);
            var hours = Math.floor(time / 3600);
            minutes = Math.floor(time / 60) % 60;
            seconds = time % 60;

            var displaySeconds = ":";
            var displayMinutes = ":";
            var displayHours = "";

            if (seconds < 10) {
                displaySeconds = ":0";
            }
            if (seconds % 60 === 0) {
                displaySeconds = ":0";
            }
            if (minutes < 10) {
                displayMinutes = ":0";
            }
            if (hours < 10) {
                displayHours = "0";
            }

            document.getElementById("timer").innerHTML = displayHours + hours +
                displayMinutes + minutes + displaySeconds + seconds;

            if (time === 0) {
                console.log("zerooooooooo");
                clearInterval(interval);
                document.getElementById("startPause").innerHTML = "Start";
                isCountdownSet = false;
                running = false;
                soundEffect.play();
            }
        }, 1000);
    }

    function reset() {
        running = false;
        isCountdownSet = false;
        clearInterval(interval);
        document.getElementById("minutes").value = 0;
        document.getElementById("seconds").value = 0;
        document.getElementById("startPause").innerHTML = "Start";
        document.getElementById("timer").innerHTML = "00:00:00";
        time = 0;
    }
</script>
</body>
</html>