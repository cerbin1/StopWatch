<!DOCTYPE html>
<html lang="pl">
<head>
    <title>Countdown</title>
    <meta charset="utf-8">
    <link rel="stylesheet" href="style.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
</head>
<body>
<div class="container">
    <div id="timer" class="buttons">00:00:00</div>
    <div class="navbar">
        <ul class = "countdown-buttons">
            <li id="startPause" class = "centering-buttons" onclick="startPause()">Start</li>
            <li id="reset" onclick="reset()">Reset</li>
        </ul>
    </div>

    <p id="here"></p>

    <div class="backButton"><a href="index.html">Back</a></div>
    <div id=""></div>
    <label for="">Minutes<input id="minutes" type="number" value="0"></label>
    <label for="">Seconds<input id="seconds" type="number" value="0"></label>
    <input class = "input-button" type="button" onclick="setCountdown()" value="Set">

</div>
<script>
    var i;
    var time = 0;
    var running = false;
    var isCountdownSet = false;
    var audio = new Audio('sound/phone_sound_effect.mp3');

    function setCountdown() {
        if (running == false) {
            if (((Math.floor(document.getElementById("seconds").value) == document.getElementById("seconds").value)) && (Math.floor(document.getElementById("minutes").value) == document.getElementById("minutes").value)) {
                if (!(document.getElementById("seconds").value < 0) && !(document.getElementById("minutes").value < 0)) {
                    if ((document.getElementById("seconds").value != 0) || (document.getElementById("minutes").value != 0)) {
                        var seconds = document.getElementById("seconds").value;
                        var minutes = (+document.getElementById("minutes").value + Math.floor(seconds / 60)) % 60;
                        var hours = Math.floor(document.getElementById("minutes").value / 60);

                        displayCountDown(seconds, minutes, hours);

                        isCountdownSet = true;
                        time = +document.getElementById("seconds").value + document.getElementById("minutes").value * 60;
                    }
                    else {
                        console.log("Musisz wpisac jakis czas, nie moze byc zerowy");
                    }
                }
                else {
                    console.log("nie moze byc ujemnego czasu");
                }
            }
            else {
                console.log("wpisane liczby nie sa liczbami calkowitymi");
            }
        }
        else {
            console.log("licznik teraz dziala, nie mozna ustawic innego czasu");
        }
    }

    function displayCountDown(seconds, minutes, hours) {
        seconds = document.getElementById("seconds").value;
        minutes = (+document.getElementById("minutes").value + Math.floor(seconds / 60)) % 60;
        hours = Math.floor(document.getElementById("minutes").value / 60);
        var displaySeconds = ":";
        var displayMinutes = ":";
        var displayHours = "";

        if (seconds < 10) {
            displaySeconds = ":0";
        }
        if (seconds % 60 == 0) {
            displaySeconds = ":0";
        }
        if (minutes < 10) {
            displayMinutes = ":0";
        }
        if (hours < 10) {
            displayHours = "0";
        }
        document.getElementById("timer").innerHTML = displayHours + hours +
                displayMinutes + minutes + displaySeconds + seconds % 60;
    }
    function startPause() {
        if (running) {
            running = false;
            clearInterval(i);
            document.getElementById("startPause").innerHTML = "Resume";
            console.log("zapausowalem");
        }
        else if (time == 0) {
            console.log("uzytkownik nie wprowadzil zadnych wartosci");
        } else {
            console.log("odpalilem");
            running = true;
            document.getElementById("startPause").innerHTML = "Pause";
            decrement();
        }
    }
    function decrement() {
        console.log(time);
        i = setInterval(function () {
            time--;

            console.log(time);
            var hours = Math.floor(time / 3600);
            minutes = Math.floor(time / 60) % 60;
            seconds = time % 60;

            var displaySeconds = ":";
            var displayMinutes = ":";
            var displayHours = "";

            if (seconds < 10) {
                displaySeconds = ":0";
            }
            if (seconds % 60 == 0) {
                displaySeconds = ":0";
            }
            if (minutes < 10) {
                displayMinutes = ":0";
            }
            if (hours < 10) {
                displayHours = "0";
            }

            document.getElementById("timer").innerHTML = displayHours + hours +
                    displayMinutes + minutes + displaySeconds + seconds;

            if (time == 0) {
                console.log("zerooooooooo");
                clearInterval(i);
                document.getElementById("startPause").innerHTML = "Start";
                isCountdownSet = false;
                running = false;
                audio.play();
            }
        }, 1000);
    }
    function reset() {
        running = false;
        isCountdownSet = false;
        clearInterval(i);
        document.getElementById("minutes").value = 0;
        document.getElementById("seconds").value = 0;
        document.getElementById("startPause").innerHTML = "Start";
        document.getElementById("timer").innerHTML = "00:00:00";
        time = 0;
    }
</script>
</body>
</html>