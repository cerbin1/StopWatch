<!DOCTYPE html>
<html lang="pl">
<head>
    <title>Stopwatch</title>
    <meta charset="utf-8">
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css"
          integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
</head>
<body>
<div class="container">
    <div id="timer" class="large-font text-center">00:00:00</div>
    <div class="row col-md-6 col-md-offset-3">
        <div class="btn-group btn-group-justified">
            <a id="startPause" onclick="toggleStopwatch()" href="#" class="btn btn-success">Start</a>
            <a id="reset" onclick="resetStopwatch()" href="#" class="btn btn-danger">Reset</a>
            <a id="lap" onclick="displayLap()" href="#" class="btn btn-info">Lap</a>
        </div>
    </div>
    <div class="row col-md-6 col-md-offset-3 text-center">
        <a id="clear" onclick="clearLaps()" href="#" class="btn btn-default">Clear laps</a>
    </div>

    <div class="row col-md-6 col-md-offset-3 text-center" id="outputLaps"></div>

    <div class="row col-md-6 col-md-offset-3 text-right">
        <a href="index.html" class="btn btn-lg btn-link">Back</a>
    </div>
</div>
<script>
    var milliseconds = 0;
    var seconds = 0;
    var minutes = 0;

    var interval;
    var running = false;

    var startTime;
    var timePaused = 0;

    var numberOfLap = 0;

    function toggleStopwatch() {
        if (running) {
            timePaused = Date.now() - startTime;
            running = false;
            clearInterval(interval);
            $('#startPause').text('Resume');
        }
        else {
            running = true;
            startTime = Date.now() - timePaused;
            runStopwatch();
            $('#startPause').text('Pause');
        }
    }

    function addAdditionalZeroIfNeeded(timeUnit) {
        return ((timeUnit < 10) ? '0' + timeUnit : timeUnit);
    }

    function runStopwatch() {
        interval = setInterval(function () {
            var timePassed = Date.now() - startTime;
            milliseconds = timePassed % 1000;
            seconds = Math.floor(timePassed / 1000) % 60;
            minutes = Math.floor(timePassed / 1000 / 60);
            $('#timer').text(
                addAdditionalZeroIfNeeded(minutes)
                + ':' + addAdditionalZeroIfNeeded(seconds)
                + ':' + addAdditionalZeroIfNeeded(milliseconds));
        }, 10);
    }

    function resetStopwatch() {
        milliseconds = 0;
        seconds = 0;
        minutes = 0;
        clearInterval(interval);
        running = false;
        $('#startPause').text('Start');
        $('#timer').text('00:00:00');
    }

    function displayLap() {
        numberOfLap++;
        var lap = 'Number of lap: ' + numberOfLap + ' time: ' + minutes + ':' + seconds + ':0' + milliseconds;
        $('#outputLaps').append(lap).append('<br>');
    }

    function clearLaps() {
        numberOfLap = 0;
        $('#outputLaps').text('');
    }
</script>
</body>
</html>